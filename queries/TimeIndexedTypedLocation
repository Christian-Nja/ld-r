### Number of cultural property with a location in ArCo

PREFIX arco:     <https://w3id.org/arco/ontology/arco/>

SELECT DISTINCT

(COUNT(?culturalProperty) AS ?count )

WHERE {

    ?culturalProperty a-loc:hasTimeIndexedTypedLocation ?location .
}

### Number of distinct type of location where a Cultural Property is stored or has been stored
### and number of instances for type

PREFIX arco:     <https://w3id.org/arco/ontology/arco/>
PREFIX a-loc:    <https://w3id.org/arco/ontology/location/>

SELECT DISTINCT

?locationType, (COUNT(?locationType) as ?count)

WHERE {

    ?location           a-loc:isTimeIndexedTypedLocationOf ?culturalProperty .
    ?location           a-loc:hasLocationType              ?locationType .
}
ORDER BY ASC(?count)	

### Number of cultural property that changed location 
### group by number of chnages they did
###
### x cultural property changed location y time

PREFIX a-loc:    <https://w3id.org/arco/ontology/location/>

SELECT ?locationChanges (COUNT(?culturalProperty) as ?culturalProperty)  WHERE {

SELECT ?culturalProperty, (COUNT(?location) AS ?locationChanges)

     WHERE { 
                ?location  a-loc:isTimeIndexedTypedLocationOf ?culturalProperty .
              }
}

GROUP BY ?locationChanges ORDER BY ASC(?locationChanges)

### Filtering cultural properties that changed location x time

PREFIX a-loc:    <https://w3id.org/arco/ontology/location/>

    SELECT ?culturalProperty, (COUNT(?location) AS ?locationChanges)

    WHERE {
            ?location  a-loc:isTimeIndexedTypedLocationOf ?culturalProperty .
}
GROUP BY ?culturalProperty
HAVING (COUNT(?location) = 17)  # Here set the number


###  Retrieve for a Cultural Property: 
###           - location where is or has been stored
###           - time interval it stay in the location
###           - address of the location
###           - location type

PREFIX arco:     <https://w3id.org/arco/ontology/arco/>
PREFIX a-loc:    <https://w3id.org/arco/ontology/location/>
PREFIX cis:      <http://dati.beniculturali.it/cis/>
PREFIX tiapit:   <https://w3id.org/italia/onto/TI/>

SELECT DISTINCT

?culturalProperty ?site ?siteAddress ?locationType ?timeInterval

WHERE {

    ?culturalProperty   a-loc:hasTimeIndexedTypedLocation  ?location .
    ?location           a-loc:hasLocationType              ?locationType .
    ?location           a-loc:atSite                       ?site .
    ?site               cis:siteAddress                    ?siteAddress .
    ?location           tiapit:atTime                      ?timeInterval .
}


### A query with subquery to get all the site adresses (only one time)
### and their label 


PREFIX arco:    <https://w3id.org/arco/ontology/arco/>
PREFIX a-loc:   <https://w3id.org/arco/ontology/location/>
PREFIX cis:     <http://dati.beniculturali.it/cis/>
PREFIX rdfs:    <http://www.w3.org/2000/01/rdf-schema#>

SELECT DISTINCT
?SiteAddressLabel (COUNT(?SiteAddressLabel) AS ?count)

WHERE {
    ?SiteAddress        rdfs:label                         ?SiteAddressLabel .
    {
        SELECT DISTINCT ?SiteAddress WHERE 
            {
                      ?Site               cis:siteAddress                    ?SiteAddress .
            }
    }
    #FILTER regex(str(?SiteAddressLabel), "Italia", "i")

}

ORDER BY DESC(?count)


### A query with subquery to get all the feature 
### and their label 
### same as above but with another property

PREFIX arco:    <https://w3id.org/arco/ontology/arco/>
PREFIX a-loc:   <https://w3id.org/arco/ontology/location/>
PREFIX cis:     <http://dati.beniculturali.it/cis/>
PREFIX rdfs:    <http://www.w3.org/2000/01/rdf-schema#>
PREFIX l0:	<https://w3id.org/italia/onto/l0/>

SELECT DISTINCT
?featureLabel ?feature ?toponymName

WHERE {
    ?feature        rdfs:label                         ?featureLabel .
    {
        SELECT DISTINCT ?feature ?toponymName WHERE
            {
                      ?location               a-loc:atLocation                    ?feature .
		      ?feature		      a-loc:hasToponymInTime		  ?toponym .
		      ?toponym		      l0:name				  ?toponymName .
            }
    }
    #FILTER regex(str(?SiteAddressLabel), "Italia", "i")

}

#ORDER BY DESC(?count)


### Number of distinct geometry

PREFIX clvapit:   <https://w3id.org/italia/onto/CLV/>
PREFIX a-loc:     <https://w3id.org/arco/ontology/location/>


SELECT DISTINCT (COUNT(?geometry) as ?count)

WHERE {
    SELECT DISTINCT ?geometry WHERE
        { 
             ?culturalProperty  clvapit:hasGeometry  ?geometry
        }
}   


### Coordinates for cultural property

PREFIX clvapit:   <https://w3id.org/italia/onto/CLV/>
PREFIX a-loc:     <https://w3id.org/arco/ontology/location/>


SELECT (COUNT(?culturalProperty) AS ?count) WHERE

{

SELECT DISTINCT ?culturalProperty
WHERE
{
         ?culturalProperty  clvapit:hasGeometry   ?geometry .
         ?geometry          a-loc:hasCoordinates  ?coordinates .
             
         ?coordinates       a-loc:long            ?long ;
                            a-loc:lat             ?lat  .    
                                      
}
}


### Query to get list of country where a cultural property was stored
### 
### Use this template with hasCountry, hasProvince, hasRegion
###

PREFIX clvapit:   <https://w3id.org/italia/onto/CLV/>
PREFIX a-loc:     <https://w3id.org/arco/ontology/location/>

SELECT ?country, (COUNT(?country) as ?occurrencies) 
WHERE {
    SELECT ?country
    WHERE {

        ?location  a-loc:isTimeIndexedTypedLocationOf  ?culturalProperty  ;
               a-loc:atLocation                    ?feature  .
        ?feature   clvapit:hasAddress                  ?address  .
        ?address   clvapit:hasCountry                  ?country .
    }
}
GROUP BY ?country
ORDER BY DESC(?occurrencies)

### Query to get total number of distinct countries
### where a cultural property was stored
###
### Use this template with hasCountry, hasProvince, hasRegion

PREFIX clvapit:   <https://w3id.org/italia/onto/CLV/>
PREFIX a-loc:     <https://w3id.org/arco/ontology/location/>

SELECT (COUNT(?country) as ?count) 
WHERE
{
    SELECT DISTINCT ?country
    WHERE {

        ?location  a-loc:isTimeIndexedTypedLocationOf  ?culturalProperty  ;
                   a-loc:atLocation                    ?feature  .
        ?feature   clvapit:hasAddress                  ?address  .
        ?address   clvapit:hasCountry                  ?country .
    }
}1987 - today​​


### Query to get time interval for a location

PREFIX arco:	 <https://w3id.org/arco/ontology/arco/>
PREFIX a-loc:    <https://w3id.org/arco/ontology/location/>
PREFIX tiapit:   <https://w3id.org/italia/onto/TI/>

SELECT ?timeInterval ?start ?end
WHERE

{
	?location      a-loc:isTimeIndexedTypedLocationOf    ?culturalProperty  ;
		       tiapit:atTime		             ?timeInterval      .
        ?timeInterval  arco:startTime                        ?start		;
		       arco:endTime			     ?end		.
}

